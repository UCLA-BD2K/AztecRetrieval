
==== Front
PLoS Comput BiolPLoS Comput. BiolplosploscompPLoS Computational Biology1553-734X1553-7358Public Library of Science San Francisco, USA 24348223PCOMPBIOL-D-13-0138910.1371/journal.pcbi.1003327Research ArticleBiologyPopulation BiologyEpidemiologyEpidemiological MethodsInfectious Disease EpidemiologySpatial EpidemiologyPopulation DynamicsDisease DynamicsMetapopulation DynamicsTheoretical BiologyHeterogeneity, Mixing, and the Spatial Scales of Mosquito-Borne Pathogen Transmission Heterogeneity, Mixing, and Pathogen TransmissionPerkins T. Alex 12*Scott Thomas W. 12Le Menach Arnaud 3Smith David L. 1341 Fogarty International Center, National Institutes of Health, Bethesda, Maryland, United States of America2 Department of Entomology, University of California, Davis, California, United States of America3 Center for Disease Dynamics, Economics and Policy, Washington, D.C., United States of America4 Department of Epidemiology, Johns Hopkins Bloomberg School of Public Health, Baltimore, Maryland, United States of AmericaSalathé Marcel EditorPennsylvania State University, United States of America* E-mail: taperkins@ucdavis.eduThe authors have declared that no competing interests exist.

Conceived and designed the experiments: TAP ALM DLS. Performed the experiments: TAP DLS. Analyzed the data: TAP DLS. Contributed reagents/materials/analysis tools: TAP TWS ALM DLS. Wrote the paper: TAP DLS.

12 2013 12 12 2013 10 2 2014 9 12 e10033276 8 2013 24 9 2013 2013Perkins et alThis is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.The Ross-Macdonald model has dominated theory for mosquito-borne pathogen transmission dynamics and control for over a century. The model, like many other basic population models, makes the mathematically convenient assumption that populations are well mixed; i.e., that each mosquito is equally likely to bite any vertebrate host. This assumption raises questions about the validity and utility of current theory because it is in conflict with preponderant empirical evidence that transmission is heterogeneous. Here, we propose a new dynamic framework that is realistic enough to describe biological causes of heterogeneous transmission of mosquito-borne pathogens of humans, yet tractable enough to provide a basis for developing and improving general theory. The framework is based on the ecological context of mosquito blood meals and the fine-scale movements of individual mosquitoes and human hosts that give rise to heterogeneous transmission. Using this framework, we describe pathogen dispersion in terms of individual-level analogues of two classical quantities: vectorial capacity and the basic reproductive number, . Importantly, this framework explicitly accounts for three key components of overall heterogeneity in transmission: heterogeneous exposure, poor mixing, and finite host numbers. Using these tools, we propose two ways of characterizing the spatial scales of transmission—pathogen dispersion kernels and the evenness of mixing across scales of aggregation—and demonstrate the consequences of a model's choice of spatial scale for epidemic dynamics and for estimation of , both by a priori model formulas and by inference of the force of infection from time-series data.

Author Summary
Pathogens transmitted by mosquitoes, such as malaria and dengue, are notorious for the biological complexity associated with how they are transmitted within local communities. Yet mathematical models for these pathogens, which are critical tools for making recommendations for control policy, are based around concepts originally designed to describe how molecules interact in chemical systems. To provide those interested in mosquito-borne diseases a more appropriate tool for modeling their transmission, we introduce a mathematical framework that is based on the spatial locations where mosquitoes lay eggs and feed on blood and how mosquitoes and hosts move about those locations. Analysis of this framework shows that the transmission contributions of different hosts and locations can be calculated, and that overall potential for transmission in a community depends on three concepts: heterogeneous exposure (some people bitten by mosquitoes more than others), poor mixing (non-random contacts between hosts and mosquitoes), and finite population sizes (each host can contribute at most one new infection towards the population total). Together, these factors determine critical levels of vaccination coverage to eliminate a pathogen and the spatial areas over which transmission should be modeled and studied in the field.

This work was supported by the Research and Policy for Infectious Disease Dynamics (RAPIDD) program of the Science and Technology Directory, Department of Homeland Security, and Fogarty International Center, National Institutes of Health. DLS and ALM (49446) and TWS (OPP52250) acknowledge funding from the Bill and Melinda Gates Foundation. DLS (U19AI089674) and TWS (R01 AI069341) acknowledge funding from the NIH/NIAID. DLS acknowledges funding from the Bloomberg Family Foundation. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.
==== Body
Introduction
Dynamic models of mosquito-borne pathogens are being used in scientific research to investigate the mechanisms and processes underlying transmission and in policy research to give advice about malaria elimination and global malaria eradication [1]–[4], stratification of a country to improve disease control [5]–[9], strategies for managing the evolution of resistance to insecticides and antimalarial drugs [10], [11], and ideal properties, potential impact, and delivery strategies for new vaccines, drugs, and vector control technologies [5], [12]–[14]. Giving robust policy advice on these issues requires extending the current evidence base and theory to weigh various sources of heterogeneity, which are known to affect transmission of mosquito-borne and other pathogens. The first mathematical models of directly transmitted infectious agents and mosquito-borne pathogens [15], [16], as well as most subsequent models, have nonetheless assumed that transmission obeys the law of mass action [17], a convenient mathematical formulation that was first developed to model chemical reactions and has since been applied in a wide range of other contexts. Mass action assumes that encounters in a very large population are so well mixed that different types interact randomly and in direct proportion to their densities. Whereas this assumption may be suitable for modeling infectious diseases in some contexts, it is also important to know when the mass-action assumption breaks down. Here, we develop a new mathematical framework capable of assessing the appropriateness of the mass-action paradigm at different spatial scales and investigating the biological heterogeneities underpinning these scaling relationships.

Heterogeneous transmission of pathogens is a pervasive issue. In populations afflicted by sexually transmitted diseases, certain individuals engage in sexual activity more frequently and with different partners than others [18]. With respect to other types of directly transmitted diseases, individuals come into contact with limited subsets of their population depending on patterns of routine movement or social relationships [19], [20]. Such individual variation in contact patterns means that some individuals play a much more important role in transmission than others, which has considerable implications for the emergence, spread, persistence, epidemiology, and control of pathogens [21]–[25].

Transmission of mosquito-borne pathogens is also heterogeneous. At relatively coarse scales, transmission heterogeneity has been described in terms of spatial “hotspots” [26], whereas at finer scales it has been described in terms of heterogeneous biting: the highly skewed distribution of biting in which 20% of the host population gets 80% or more of all the bites [22]. At those fine scales, DNA profiling of mosquito blood meals provides direct evidence for heterogeneous biting by the mosquitoes that transmit filarial worms, dengue virus, and malaria parasites [27]–[29]. Studies have shown that heterogeneous mosquito biting is associated with human body size [30], [31], defensive behavior [32], [33], pregnancy [34], [35], blood type [36], alcohol consumption [37], [38], and some volatile chemicals [39] found in breath and sweat [40]–[43]. Other studies have found that heterogeneity exists among households due to factors such as proximity to the aquatic habitats of immature mosquitoes [26], the type of house [44], [45], the prevailing direction of the wind [46], and other factors associated with mosquito movement patterns [46]–[48]. Yet others have proposed that the patterns of routine movement by hosts may put some at greater risk of exposure to mosquitoes than others [49], [50]. Specifically, hosts that spend more time at locations with high mosquito densities at times when mosquitoes are actively biting have a greater risk of being bitten [51]–[53]. Altogether, abundant evidence from decades of empirical research shows that pathogen transmission is highly heterogeneous at a variety of scales, that it has many causes, and that it is epidemiologically important for mosquito-borne pathogens [24], [25], [54].

Despite the ubiquitous evidence for heterogeneous transmission, mathematical models of mosquito-borne pathogen transmission rarely consider these complexities and usually assume mass action [17]. There are, of course, a number of notable exceptions to this rule, including [24], [25], [54]–[57] and especially [21], [58], which provide general theoretical insights about the impact of heterogeneous transmission on mosquito-borne pathogen transmission. Unfortunately though, the impact of this work on modeling and policy for mosquito-borne diseases has been limited [17], likely because of the lack of a clear path to connect these rather abstract models to the complex biology of real systems. Instead, much recent attention has focused on the development of simulation-based models [59]–[65], which incorporate a great deal of biological complexity but do so at the expense of the analytical tractability and broad insight afforded by [21], [58] and others. An intermediary set of tools striking an appropriate balance between the transparency of simple, abstract models and the complexity of simulation-based models could provide a useful shortcut to basic insights on which policy decisions often depend.

In addition to their academic intrigue, these questions about heterogeneity and mixing are highly relevant for measurement of transmission and application of theory to real problems. One of the ways in which patterns of heterogeneity and mixing most directly influence the interface of theory and reality is by how they determine the spatial scales that characterize transmission. Without theory to inform practitioners about realistic scales of transmission, how are decisions to be made about the appropriate sampling frame for making valid inference about transmission? How are decisions to be made about basic questions such as the sample sizes required to achieve an appropriate degree of accuracy or precision for measurements to inform target intervention coverage levels or disease control measures? Characterizing the spatial scales of transmission is also relevant for designing randomized control trials for transmission blocking malaria vaccines and tetravalent dengue vaccines where study populations are influenced by surrounding populations, as well as for understanding the causes and consequences of the area effects observed in some bed net trials [66], [67]. Theory and practice for mosquito-borne pathogen transmission and control thus requires a better characterization of heterogeneity, mixing, and the spatial scales that characterize transmission and control.

To address these gaps about heterogeneity, mixing, and the appropriate spatial scales for measuring and modeling transmission, we took a reductionist perspective and developed a mathematical framework that is based on the ecological context of encounters between adult female mosquitoes and their vertebrate hosts. From this, we derived mathematical formulas describing heterogeneous biting, transmission thresholds, and the spatial scales of transmission. In particular, we calculate next-generation matrices, individual reproductive numbers, and the population-level basic reproductive number, . These approximations build on previous work on heterogeneous biting [21], [58], but utilize a more mechanistic biological model and account for an inherent nonlinearity posed by finite host numbers, as in [68]. Leveraging the spatial specificity of our model, we demonstrate how these matrices can be used to characterize the spatial scales of transmission, and we provide examples of how models with inappropriate assumptions about these scales can lead to faulty prediction and inference.

Results
The Ross-Macdonald model assumes well-mixed transmission of a pathogen within a host population of indeterminate size. The potential intensity of transmission is determined by five parameters: (1) the population density of mosquitoes; (2) mosquito survival; (3) the time required to complete one cycle of mosquito feeding and egg laying; (4) the propensity for mosquitoes to feed on the pathogen's vertebrate host; and (5) the pathogen's extrinsic incubation period in the mosquito [5], [69]. These five parameters comprise vectorial capacity, also known as the daily reproductive rate, which is defined as the expected number of infectious bites that could arise (assuming perfectly efficient pathogen transmission to mosquitoes from the vertebrate host) from all the mosquitoes that bite a single host on a single day. This parsimonious model has been widely used [17], but it is difficult to modify this simple framework as a tool for investigating transmission because key aspects of mosquito behavior, including blood feeding and the corresponding host behaviors, are treated phenomenologically.

We developed a new mechanistic, mathematical framework for modeling the micro-epidemiology of mosquito-borne pathogen transmission. Our model is based on the biological activities of the mosquitoes and hosts—particularly their movements—that allow a pathogen to disperse, and it was formulated in a way that makes it possible to analyze transmission mathematically (Fig. 1). Our model is capable of utilizing very detailed information about transmission in a particular place, but the level of detail that could be used to fully calibrate models of this sort in a single place exceeds the capacity of field biologists to measure it. Rather than serving as a focal point for calibration, then, our purpose was to design a model that is flexible enough that it can serve as a tool for conducting experiments in silico to identify the biological details that are most relevant for transmission dynamics and disease control.

10.1371/journal.pcbi.1003327.g001Figure 1 Model schematic.
The model is specified on a continuous landscape with a point set of blood-feeding habitats, , and a point set of aquatic habitats, . The model is discrete in time with a time step equal to the length of the mosquito feeding cycle, in which mosquitoes take a blood meal, search for aquatic habitat (, red arrow), lay eggs, and repeat the search for another blood meal (, green arrow). Each host in  allocates its time proportionally at multiple blood-feeding habitats (, brown arrows). During a single feeding cycle, each mosquito present at a given blood-feeding habitat takes a single blood meal, the collection of which are distributed differentially on hosts according to the proportion of time each spends there and a quantity describing each host's biting suitability (). This model structure allows for the derivation of weighted, bidirectional networks that summarize pathogen dispersion among blood-feeding habitats (houses) or among hosts (circles). From this process-based description of transmission, it is possible to derive network summaries of pathogen dispersion. Pathogen dispersion by mosquitoes:  describes how mosquitoes taking an infective blood meal at one blood-feeding habitat distribute secondary, potentially infectious bites at other blood-feeding habitats. Pathogen dispersion by hosts:  specifies the probability that a secondary bite on a human infected at one blood-feeding habitat takes place at some other blood-feeding habitat. Pathogen amplification:  gives the total number of secondary bites on a host arising from primary bites on another host in a single feeding cycle. Host infection:  contains the probabilities that a primary infection in one host will result in a secondary infection in some other host.

We also developed a parallel mathematical framework for modeling the macro-epidemiology of a mosquito-borne pathogen; i.e., a patch-based or metapopulation model (e.g., [70]). This macro-epidemiological model serves as a bridge between the complex, detailed micro-epidemiological framework and more recent patch-based Ross-Macdonald-like models, and we have developed utilities to map the models onto one another in limiting cases. The following sections describe the factors that give rise to heterogeneous biting, matrices describing the networks along which pathogens disperse, and concepts and metrics to measure the scales of transmission. Within this framework, we also simulate transmission and compare different criteria for the critical fraction of a population that must be vaccinated for a pathogen to be unable to sustain endemic transmission.

Heterogeneous Biting
The Ross-Macdonald model assumes homogeneous biting: a mosquito is equally likely to bite any individual in the vertebrate host population. Most evidence suggests that biting is highly heterogeneous, and that heterogeneous biting is an important quantitative feature of transmission. The framework we devised gives a mathematical description of three distinct processes that give rise to heterogeneous biting: the distribution of mosquito biting among different places, the number of hosts present at those places, and a rule describing how the bites are allocated among the hosts who are present. The way these assumptions manifest mathematically and their relevance to transmission dynamics are discussed in detail in the Methods section.

Mosquito blood meals are the focal event in pathogen transmission, and our model is based on a mathematical construct describing where and when mosquito-host encounters occur. Many mosquitoes have well-defined haunts and blood-feeding habits, such that blood feeding tends to occur in places that can be reasonably well characterized. These are rigorously described as a set of points, denoted , containing  objects, called blood-feeding habitats. A way of defining  could be to consider the collection of homes in a city, which might be appropriate for human populations afflicted by malaria or dengue. Another, more flexible option would be to impose a lattice over an area and aggregate blood-feeding that takes place nearest to each point on the lattice. In either case, mosquito movement among the blood-feeding habitats is based on some description of mosquito behaviors relevant to the ecological needs dictated by a given species' natural history.

In the model, another set of points, denoted , containing  objects, describes the aquatic habitats where mosquito eggs are laid, develop into larvae, and then pupate before emerging as adults. At times, adult female mosquitoes make movement decisions based on the need for blood feeding, digestion and rest, sugar feeding, mating, egg laying, or to satisfy other biological needs. At a minimum, movements of epidemiological interest are those geared towards blood feeding and egg laying. Here we focus on the dispersion of mosquitoes (and of the pathogen by mosquitoes) based largely on matrices describing in probabilistic terms how mosquitoes move from aquatic habitats to blood-feeding habitats () and then vice versa to lay eggs (). These matrices are derived from the co-distribution of the two point sets and mosquito search algorithms describing how mosquitoes locate and choose a particular blood-feeding habitat or a particular aquatic habitat. These matrices describe patterns of egg laying and blood feeding by adult mosquitoes as they move among aquatic habitats to lay eggs () or among blood feeding habitats to blood feed (). The formulas suggest a close correspondence between movements for mosquito egg laying and movements for mosquito blood feeding and pathogen transmission.

The number of bites at each blood feeding habitat is related to these movement rules and to the productivity of each aquatic habitat, defined as the number of adult mosquitoes emerging from that habitat each day, . Productivity depends on the number of eggs laid and the changes in larval survival in response to available food and crowding in each aquatic habitat, as well as other factors. The number of eggs laid by adult mosquitoes in each habitat is, in turn, related to the patterns of emergence and movement patterns of adult mosquitoes, generally after taking a blood meal. The dynamic coupling between blood feeding by adult mosquito populations and the ecology of aquatic mosquito populations is of great importance for mosquito population dynamics and pathogen transmission.

The location of aquatic habitats and ecology of immature mosquitoes can be highly variable (e.g., due to changes in rainfall, temperature, resource availability, predation), but if the conditions remain constant, formulas describe the productivity at the steady state. Under these assumptions, it is possible to compute the number of bites occurring at each blood-feeding habitat, . This is, in theory, the in silico analogue of the number of mosquitoes present at each blood-feeding habitat on each day and, therefore, proportional to the number that would be caught in a population monitoring program. For humans, it is thus related to the household biting rate that could be measured with pyrethroid spray catches, exit traps, CDC light traps, or by aspiration.

As a practical way of computing human biting rates (i.e., the number of mosquito bites by vector species, per human, per day) from field data describing household biting rates, the number of mosquitoes caught is divided by the number of humans living in a house. In fact, some of those bites can occur on people who do not live in the house, and conversely some biting can occur on humans while they are at other people's houses. Similar arguments apply generally to other host populations. To complete the picture of heterogeneous biting, a description of host movement is required.

Movement behaviors of hosts are complex, with requirements to visit certain locations for sustenance or social interactions, for example. To avoid the specificity of those complexities, we define a set of hosts, , and represent host movement simply by the proportion of an individual's time, on average, allocated at each blood-feeding habitat at times when mosquitoes are actively feeding, described by a matrix . Hosts do not necessarily allocate their time at a location because there are or are not mosquitoes present, so the proportion of time a host allocates at all blood-feeding habitats could sum to less than one if it spends some of its time elsewhere.

The distribution of mosquito blood meals among all the hosts present is modeled as the confluence of mosquito and human movement leading to a set of potential encounters at a particular blood-feeding habitat. Complicated host behavioral responses, such as avoiding mosquitoes when their densities are high, can be simulated in this framework, but what matters for heterogeneous biting is the actual distribution of bites, which is determined in the model by a simple rule that allocates bites among hosts. A single number determines this rule, called the biting suitability score, denoted , which summarizes a large number of host factors (e.g., body size, use of an ITN, wearing protective clothing, defensive behavior, etc.) that determine the proportion of bites that occur on each human at each location. A matrix, , is derived that describes the expected number of bites occurring on each host at each blood-feeding habitat. Each row of  describes how mosquito blood feeding is allocated among humans at a particular place, and each column in  describes how many bites a particular human receives at every location. Heterogeneous biting is described by the normalized column sums that give a person's biting weight, , which is the proportion of all the bites taken on each person.

In sum, heterogeneous biting is the product of the following: 1) mosquito population dynamics and movement leading to heterogeneity in the number of mosquitoes present at each blood feeding habitat; 2) the number of hosts sharing the risk at each blood feeding habitat and a rule that determines how the bites are distributed among them; and 3) the mobility of the blood meal hosts and their propensity to spend time at risk among many blood feeding habitats. Heterogeneous biting, in this framework, is represented in matrix form, emphasizing the difficulty of measuring heterogeneous biting in any simple way. The measures that can be used to estimate heterogeneous biting by catching mosquitoes at a place give a partial and useful snapshot of a more complicated process. This mathematical description outlines how it would be possible to integrate all the factors contributing to heterogeneous biting and give a full estimate.

Pathogen Dispersion
A pathogen's transmission through a population is typically thought of in terms of the total number of hosts infected by each infected mosquito, and vice versa [17]. In the Ross-Macdonald theory for mosquito-borne pathogen transmission, well-known quantities of this type include vectorial capacity and the basic reproductive number, 
[68], [71]. Complementing these measures of potential transmission is a set of closely related field metrics measuring the intensity of biting and exposure including the human biting rate and the entomological inoculation rate [5], [72]. Here, we use the framework to explore the richer dynamics of pathogen transmission and the patterns of dispersion among specific locations and individuals that give rise to the distributions of biting by describing probabilistic movement processes of individual mosquitoes, hosts, and pathogens structured by the locations of mosquito blood-feeding habitats. We use this framework to describe heterogeneous biting, pathogen dispersion, vaccine thresholds, the degree of mixing, and characteristic spatial scales of pathogen transmission.

The matrix descriptions of mosquito and human movement (above, Fig. 1) were also used to derive matrices describing pathogen dispersion by mobile mosquitoes that account for mortality during pathogen incubation in the mosquito and all subsequent blood meals (), pathogen dispersion by mobile hosts (), and dispersion through the full transmission cycle. The core of our analysis of pathogen transmission utilizes next-generation matrices that encode the networks we call  and , corresponding to the classical concept of vectorial capacity and reproductive numbers. The matrix  contains the expected number of secondary bites on a host that comes from mosquitoes that took a primary bite on a given host during a single feeding cycle. The matrix  contains the probabilities that each one of the individual hosts will be infected by secondary infectious bites derived from any other given host. These matrices, as well as  and , effectively define weighted, bidirectional networks of expected pathogen transmission between locations or between individual hosts (Fig. 1). Summing across the rows of  and  yields vectors that we call  and . Rather than describing the expected numbers of secondary bites or infections between every pair of hosts, they contain the total numbers of expected secondary bites or infections arising from each primary (i.e., reference) host. These vectors thus serve as literal, individual-level analogues of vectorial capacity and 
[71].

Spatial Scales of Transmission
Because our model formulation is inherently spatial, it presents a unique opportunity to answer questions about the spatial scales of pathogen dispersion. These scales, which define how localized transmission is, are directly relevant to a number of practical issues in the study and control of mosquito-borne pathogens. Examples include how big of an area must be sampled to estimate human biting rates, how large of an area must be sprayed to control an outbreak, the number of houses to visit for active case detection, and over what area must vaccines be distributed to effect sufficient herd immunity to attain local elimination? Answers a mathematical model provides to these questions will depend very much on its assumptions about spatial scales.

Distance Kernels
One very direct way to characterize the spatial scales of transmission under our framework is to compute distance kernels for any or all of the matrices we derived. These kernels are probability densities over space that describe how far away the events summarized by each matrix take place relative to where they originated. For example, the distance kernel, , for the  matrix describes the probability that, at some point in its life, a mosquito takes a blood meal a distance  away from where it took a previous blood meal. The distance kernel, , for the  matrix (a spatial analogue of ) describes the probability that a secondary vertebrate host contracts the pathogen a distance  away from where its corresponding primary host contracted the pathogen. These kernels can be specified either as a collection of kernels for individual hosts or locations, or they can be averaged over the population. And while they give a rich description of pathogen dispersion in space, they can also be used to give a simple and direct answer to the question of what the spatial scales of transmission are: the average distance, , between where consecutive events take place. Fig. 2 contains examples of these kernels for a simulated landscape.

10.1371/journal.pcbi.1003327.g002Figure 2 Spatial kernels.
Panels correspond to the matrices that summarize pathogen dispersion by mosquitoes (a), pathogen dispersion by vertebrate hosts (b), pathogen dispersion through both species (c), and the spread of secondary host infections (d). Gray histograms show the empirical densities of each matrix's weighting at different distances, and black curves show a smoothed version of these data. Dashed lines show the average distance at which the events described by each matrix take place and therefore represent one way of defining the spatial scales of transmission with a single number. For example, the dashed line in (d) indicates that, on average, mosquito bites conferring a secondary host infection occur a distance of E away from where the corresponding primary host transmitted the pathogen to a mosquito.

Mixing within Patches
Another way to define the spatial scales of transmission is to consider mixing within a “patch” of a given size. Patch, or metapopulation, models of mosquito-borne pathogen transmission assume that interactions within each patch are random and that movement between patches by mosquitoes and hosts occurs at various rates. To begin to address the issue of the spatial scales of transmission in this patch context, we must first define two related but distinct concepts: heterogeneity and mixing. In a patch that is well mixed but displays high heterogeneity, mosquitoes take more bites on some hosts than others, but the identities of hosts that receive consecutive bites from a mosquito are uncorrelated. In a patch that is poorly mixed, there are in some sense “partnerships” between certain mosquitoes and certain hosts, whereby a mosquito that has bitten one host is more likely to then bite certain hosts than others.

Both of these properties likely manifest in natural systems, but they derive from different processes and have different implications for model structure and dynamics. What we term as heterogeneity is typically thought to derive from preferential biting by mosquitoes on certain hosts, but it can also be impacted by the extent to which people spend time in places with lots of mosquitoes and how many other people there are to dilute their risk of biting. Regardless of its causes, this property is relatively easy to include in a patch model (e.g., [21], [68]). Mixing, on the other hand, is fundamentally a “distance” concept. For example, mosquitoes that bite one host are more likely to take their next blood meal on that host, its cohabitants, or other hosts nearby, than they are to subsequently encounter a host that is far away. The concept of distance may also apply to proximity on a social network, as well [50]. Patch models universally assume that interactions within a patch are perfectly mixed, so using a more reductionist framework like ours provides an opportunity to test the validity of this assumption at different scales. Intuitively, one would expect small patches with frequent interactions among few actors to be well mixed relative to increasingly large patches with less frequent interactions among a larger pool of actors. Characterizing this relationship and identifying at what scale patches tend to become poorly mixed is precisely our goal.

To quantify these properties we need mathematical definitions of the concepts of a patch, a description of transmission within a patch, and a way to separate heterogeneity and mixing. This procedure could potentially be applied to any of our matrices, but we focus on the  matrix, which is most relevant to the spatial scales of transmission among hosts. This matrix is defined on the set of blood-feeding habitats, so in this case a patch could be defined as any subset . Because here we are concerned only with dynamics within a patch, we focus on the matrix , which is obtained by deleting all rows and columns of  that correspond to blood-feeding habitats outside of the focal patch . In the context of the  matrix, heterogeneity manifests as uneven total contributions of transmission from hosts at different constituent locations, whereas mixing manifests as an uneven distribution of secondary infections arising from hosts at each constituent location. Mathematically then, heterogeneity in a patch is concerned with the sums across the rows, and mixing is concerned with the normalized vectors from each row. The extrema of mixing are the scenarios in which 1) all values of the normalized rows are equal (perfectly mixed), and 2) one entry of each normalized row equals 1 and the rest equal 0 (no mixing). A familiar measure with extrema corresponding to these scenarios, and that can be used to quantify the myriad possibilities in between, is evenness [73]. Our proposed measure of mixing within a patch therefore uses the matrix , whose rows equal the normalized rows of , to define (1)  which provides a quantitative basis for comparing the degree of mixing in different patches.

To address the issue of the spatial scales of transmission, we chose patches of different sizes and examined the relationship between mixing and a patch's size and spatial extent. For a given set of blood-feeing habitats, , there are any number of reasonable ways to choose patches for this analysis. The algorithm that we adopted involves starting from a full set  and agglomerating groups of locations based on the distance between their centroids, doing so successively until all  are grouped together in a single patch (Figs. 3, 4). Given definitions of different patches representing the full spectrum of patch size and spatial extent, we then evaluated the evenness of mixing, , on each of them. As expected, there is a clear positive relationship between patch size (and spatial extent) and poor mixing (Fig. 3). One way to make use of this relationship to define the spatial scales of transmission is to select a threshold value of the evenness of mixing and select the set of patches whose  correspond to that threshold. Regardless of the specific value chosen for this threshold, it is nonetheless a useful procedure for establishing how mixing varies across spatial scales and for comparing this relationship across different ecological contexts (e.g., columns of Fig. 3).

10.1371/journal.pcbi.1003327.g003Figure 3 Mixing across scales.
Evenness of mixing of secondary infections within subsets of blood-feeding habitats under different assumptions about their spatial arrangement. Phylograms are structured from bottom (depiction of spatial arrangement of blood feeding habitats) to top (by spatial extent and patch size) such that nearby blood-feeding habitats are grouped together, nearby groups combine to form larger groups, and so on, until all blood-feeding habitats are grouped together. Colors on the branches of the phylograms show the evenness of mixing in the diagonal submatrix of  corresponding to blood-feeding habitats that comprise each cluster.

10.1371/journal.pcbi.1003327.g004Figure 4 Heterogeneity across scales.
Heterogeneity of outgoing secondary infections from subsets of blood-feeding habitats under different assumptions about their spatial arrangement. Phylograms are structured from bottom (depiction of spatial arrangement of blood feeding habitats) to top (by spatial extent and patch size) such that nearby blood-feeding habitats are grouped together, nearby groups combine to form larger groups, and so on, until all blood-feeding habitats are grouped together. Colors on the branches of the phylograms show the coefficient of variation of the sums across the rows of the diagonal submatrix of  corresponding to blood-feeding habitats that comprise each cluster.

Although mixing is expected to vary across spatial scales and thus be most informative for an effort to identify the spatial scales of transmission, it is also likely that there is epidemiologically relevant variation in the heterogeneity displayed within different patches. To explore this variation, we took the same hierarchy of patches from the analysis of mixing and, for each patch, evaluated the coefficient of variation of sums across each row of  (Fig. 4). In doing so, we find that small, spatially restricted patches display a great deal of variation in the extent of within-patch heterogeneity and that the largest, most expansive patches tend to have moderate to high heterogeneity. Thus, there is potential for heterogeneity at all spatial scales, but it appears to be increasingly visible at larger scales that involve aggregation over more individuals and larger areas.

Dynamics across Scales
Given these ways of characterizing the spatial scales of transmission, a natural question that arises is how epidemiological dynamics and the impacts of control measures vary across systems with different characteristic scales of transmission or across multiple spatial scales in a single system. Because all models must make one assumption or another about the relationship between heterogeneity, mixing, and the spatial scales of transmission, the answer to this question has direct implications for the accuracy of quantitative predictions flowing from them. Below, we use our modeling framework to illustrate that models with differing assumptions about heterogeneity and mixing make vastly different quantitative predictions about epidemic dynamics and -based vaccination thresholds.

Epidemic Dynamics
Although the concepts of heterogeneity and mixing can be disentangled in summary matrices such as  and , it is less straightforward to separate them in the full model because heterogeneous biting and contacts tend to go hand in hand with localized movement and poor mixing. It is nonetheless instructive to consider the different dynamics exhibited by models at both extremes: i.e., one with localized movement and heterogeneous exposure, and one with uniform movement and exposure.

Simulating 100 realizations of an epidemic with our stochastic model, we see that poor mixing and heterogeneity have considerable impacts on the number of infected hosts over time (Fig. 5c). Most notably, an epidemic in a heterogeneous, poorly mixed system progresses more slowly, has a more variable progression over time, and ultimately infects fewer hosts than would be suggested by a model that assumes uniform, well-mixed interactions at the same spatial scale. A clue to understanding why these different scenarios exhibit different dynamics can be found by examining the cumulative exposure of individual hosts in the population over time. In a model with well-mixed interactions and uniform exposures, each infectious bite tends to occur on a different individual host (Fig. 5b). In a model that accounts for heterogeneous exposure and poor mixing, however, multiple infectious bites tend to consistently fall on the same subset of hosts (Fig. 5a), meaning that some bites are redundant and that there are fewer new infections over time. Any model that aggregates hosts and mosquitoes into a uniform, well-mixed whole at an inappropriately large spatial scale has the potential to exhibit dynamics that are biased in this way.

10.1371/journal.pcbi.1003327.g005Figure 5 Epidemic dynamics across scales.
When mosquito and host movement are both well mixed (a), each infectious bite originating from a single primary host is made on a unique secondary host. When mosquito and host movement are both poorly mixed (b), some hosts receive multiple infectious bites. Under these different scenarios about movement, epidemics originating in hosts with equal  unfold much differently. Pathogen spread through a well-mixed population is quick, consistent, and complete (red in c), whereas pathogen spread through poorly-mixed populations is slower, more variable, and does not infect the entire host population (blue in c).

 and Vaccination Thresholds
At any given spatial scale, there are at least three general factors acknowledged in our modeling framework that have a direct impact on estimates of the basic reproductive number, : heterogeneity, mixing, and finite numbers of hosts. The effects of these factors can be examined directly under our framework by manipulating the summary matrix .

For this comparison, we first simulated a transmission landscape and calculated  as the dominant eigenvalue of , which serves as the benchmark against which all other methods for calculating  a priori (i.e., based on parameters and a formula) can be compared. Note that this formulation allows for all three of the factors affecting  listed above. The other methods for calculating  that we consider include the Ross-Macdonald formula (reviewed in [71]), an approximation accounting for heterogeneous biting first applied to mosquito-borne pathogens by [21], an adjustment to the approximation by [21] accounting for finite-host numbers [68], and what we refer to as an “unbounded next-generation approach” that accounts for heterogeneity and poor mixing but not finite host numbers [58]. The relative values of  calculated by these different methods differ depending on the overall intensity of transmission, which can vary depending on mosquito density, mosquito lifespan, the pathogen incubation period in mosquitoes, and how often mosquitoes blood feed. As a proxy for the rest of these situations, we examined two scenarios with relatively high and low mosquito survival (low transmission and high transmission, respectively).

In a low-transmission context,  is greatest under the unbounded next-generation approach [21] and somewhat less for our approach based on the  matrix. Values of  are then progressively less for the [21] approximation, the [68] formula with heterogeneity and finite host numbers, and finally for the Ross-Macdonald formula (Table 1). In a high-transmission context, however, the methods by [58], [21], and Ross and Macdonald all lead to values of  that exceed its value under our model (Table 1). Together, these patterns suggest that the inclusion of increasingly complex heterogeneities in otherwise equivalent systems increase a priori estimates of , but that all such increases are tempered by finite host numbers in increasingly intense transmission contexts. Furthermore, the extent to which these effects of finite host numbers manifest on estimates of  depends on the presumed spatial scale of transmission. Rather than depending on host population size per se (as might be interpreted based on a literal interpretation of [68]), the effects of finite host numbers manifest at the individual level. What really matters, then, is how many potentially infectious bites are concentrated on certain individuals. For example, in the most poorly mixed system possible, mosquitoes would show biting fidelity on individual hosts, never allowing for the possibility of any secondary infections (). Were infectious bites to become distributed on larger and larger numbers of hosts, the potential for secondary infections would grow and so would . This basic reproductive rate then clearly depends very much on the extent of mixing in a population, which is a consequence of a relatively fine spatial scale of transmission vis-à-vis mosquito movement, host movement, and the spatial distributions of mosquitoes and vertebrate hosts. Because vaccination proportions, , necessary to prevent pathogen invasion or to achieve local elimination are often guided by estimates of  and the fundamental relationship , such systematic differences in a priori estimates of  due to poor mixing beyond some characteristic spatial scale are all subject to analogous systematic errors in the estimation of vaccination coverage levels (Table 1).

10.1371/journal.pcbi.1003327.t001Table 1 Basic reproductive numbers () and vaccination thresholds () calculated by methods that variously account for heterogeneity (H), poor mixing (M), and finite host numbers (F), in both low- and high-transmission contexts in a randomly simulated population.
				Low transmission	High transmission	
Method	H	M	F							
Ross-Macdonald	–	–	–	0.61	1.19	0.16	1.29	33.77	0.97	
Favier et al. 2006	–	–	–	0.72	1.41	0.29	0.07	1.85	0.46	
Dye & Hasibeder 1986	✓	–	–	0.81	1.57	0.37	1.55	40.56	0.98	
Smith et al. 2007	✓	–	✓	0.79	1.54	0.35	1.48	38.77	0.97	
Hasibeder & Dye 1988	✓	✓	–	1.09	2.11	0.53	1.86	48.70	0.98	
present study	✓	✓	✓	1	1.93	0.48	1	26.10	0.96	
 Because the value of  based on the  matrix (denoted here as ) is the most complete description of the underlying transmission process, we also list the ratio of all other values to it (). All methods compute  based solely on parameter values of the model, except Favier et al. 2006, which use both a subset of model parameters and an empirical estimate of the force of infection based on simulated epidemic data.

Another approach to estimating  is to do so based on an empirical estimate of the force of infection at the onset of an epidemic. As an example of this general approach, we compute the estimate of  derived by [74] (eq. 6), which was formulated specifically for application to mosquito-borne pathogens. Their formula depends on an empirical estimate of the force of infection, as well as the duration of infectiousness and pathogen incubation periods in hosts and mosquitoes. Importantly, the mathematical model underlying their formula is one much like the Ross-Macdonald model in that it assumes uniform exposure, perfect mixing, and does not account for the fact that each host can contract at most one secondary infection. Taking the average estimate of force of infection from 100 simulated epidemics and applying it to the formula of [74], we find that this estimate of  is consistently lower than all a priori estimates of , regardless of the intensity of transmission (Table 1). This disparity between an empirical estimate based on data from a truly heterogeneous, poorly mixed, and finite population and the true value of  in that population (i.e., our estimate based on the  matrix) can be accounted for by the fact that a model that assumes uniform exposure, perfect mixing, and an infinite supply of susceptible hosts would require much less intense transmission to produce similar dynamics (as can be intuited via Fig. 5). Were such systematically low estimates of  used to guide planning for vaccine deployment, an inadequate proportion of the population would be vaccinated and a pathogen would be more likely to invade or persist (compare  in Table 1).

Discussion
Many mathematical models of mosquito-borne pathogen transmission have focused on infection and the factors that determine the intensity of transmission at the expense of details of how pathogens disperse through populations [17]. For the time being, we have made the opposite tradeoff by eschewing many possible pathogen-specific details of infection dynamics and focusing instead on ecological aspects of dispersion common to transmission of all mosquito-borne pathogens. A central theme of this perspective is that, inasmuch as movement patterns of mosquitoes and humans are limited to relatively few mosquito blood-feeding habitats, repeated transmission events within certain groups of hosts and mosquitoes break the standard assumption of well-mixed encounters at the population level. In the likely event that movement is spatially constrained (e.g., in mosquitoes by energy expenditure and mortality risk, or in humans by convenience and cost), this effect of poor mixing gives rise to characteristic spatial scales smaller than the area over which mosquito and host populations are distributed as a whole. Using information about movement patterns and spatial distributions of mosquitoes and hosts, our model allows for these scales to be quantified in at least two ways, based on (1) spatial kernels of consecutive transmission events, and (2) patterns of mixing across scales of aggregation. We also demonstrate the consequences of ignoring poor mixing and the characteristic scales of transmission, which include misinterpreting epidemic patterns and biasing estimates of the basic reproductive number and critical vaccination threshold.

The effects of heterogeneity, poor mixing, and finite host numbers on the transmission of mosquito-borne pathogens have been described and modeled before (e.g., [21], [56]–[58], [68], [75]). Yet the simultaneous linkage of all three of these factors, which is important for more than the sake of completeness, has heretofore not been made. Two foundational theoretical papers by Dye and Hasibeder [21], [58] established that heterogeneous biting and poor mixing lead to increases in , which make pathogen invasion more likely and elimination more difficult. Later, Smith et al.
[68] noted that increases in  due to heterogeneous biting are limited by the finite number of hosts on which those bites can be distributed, implying that  may in many cases be lower than previous theory would suggest. By combining all three of these factors, we find that the truth is more complicated and likely somewhere in between. That is, heterogeneity and poor mixing do increase a pathogen's ability to invade and persist in a population, but these effects are limited by the number of hosts in an area, the size of which is determined by ecological factors that define the characteristic spatial scales of transmission. Similar to issues that arise in statistical inference based on network models [76], inferences about  or other measures of transmission made from data under mass-action assumptions are biased to an unknown degree from their true values, which depend on the extent of poor mixing. Perhaps even more troublingly, a priori estimates of vectorial capacity and  made by plugging values of component parameters into classic formulae are biased to an unknown degree and in unpredictable directions. The theoretical developments we have made represent an important step in identifying and addressing these problems, but more work to empirically quantify fine-scale heterogeneity and patterns of mixing in ecologically diverse systems is needed.

Another feature of much existing theory that may have limited its adoption or application is the lack of a clear connection to underlying biological mechanisms. Rather than address heterogeneous biting or exposure in a generic way, our model contains many of the biological elements that likely contribute to heterogeneity in real systems. The dominant mechanism for heterogeneous transmission promoted to date has been variation in factors such as body size or age of hosts. Although our results do not preclude the importance of these factors, they underscore that patterns of host and mosquito movement could also be important sources of heterogeneous transmission, too. In our model, the foremost requirement to obtain movement-based heterogeneity is that an individual host allocates its time at only a subset of locations where blood feeding occurs. This rather basic assumption means that some blood-feeding habitats will be frequented more often and by more hosts, whereas others will be visited less often. Patterns of spatial variation in mosquito density and movement of mosquitoes and hosts will then jointly determine the potential for any individual host or mosquito to transmit a pathogen to some subset of the rest of the population. Although working out such fine-scale details of heterogeneity and transmission in real systems will be a formidable challenge, our framework takes an important step by laying down the mathematical foundation with which measurable properties of individual vertebrate hosts and the locations they frequent can be translated into transmission potential. Likewise, even if such consistent variation in these characteristics cannot be assessed at an individual level, their impacts on patterns of spatial variation in transmission can be assessed with our framework at whatever scale data are available.

These advances in theory for mosquito-borne pathogen transmission have direct implications for policies regarding the deployment of control measures in these systems. In particular, vaccines have received an especially high level of interest from modelers recently [17], [77], [78] due to the late-phase trials of vaccines for dengue and malaria. Comparison of our model with some routinely applied to vaccination shows that disregard of heterogeneity, poor mixing, and finite host numbers may lead to incorrect estimates of coverage levels necessary to achieve herd immunity. Even worse, we show here that whether these models underestimate or overestimate necessary coverage levels is not always consistent, and therefore not predictable or easily correctable, across contexts. On the other hand, basing these predictions on empirical estimates of the force of infection, in combination with models based on assumptions of uniform exposure and perfect mixing, leads to a consistent bias of always underestimating necessary vaccination coverage levels. Relative to existing methods, our modeling framework also has the advantage of enabling the assessment of targeting vaccine delivery to individuals based on measurable properties, such as where they live or how extensive their social network is. In addition, the ability to calculate spatial kernels of pathogen transmission has direct applicability to determination of the coverage areas for mosquito spraying in response to active cases.

Common criticisms of individual-based models—which ours is not limited to, but is at its core—include the difficulty of parameterizing them and their analytical intractability. In practice, however, our framework provides at least some analytical insight and is clear about what parameters must be specified and the scales at which they should be measured. Specifically, the main parameters that must be specified for our model, beyond those that must be defined for any comparable model, are the spatial distribution of habitats, hosts, and mosquitoes, and movement patterns among those habitats. For many applications, the coordinates of habitats can be informed by GIS or remote sensing data [63], [79]. Data pertaining to the spatial distributions of mosquitoes and vertebrate hosts are becoming available at increasingly fine scales [80], [81], and plausible summaries of individual movement patterns linking those populations could be derived with a combination of behavioral algorithms [82] and data from movement studies [83], [84]. Even if reasonable estimates of individual- or household-level parameters are not available, the model is flexible enough to permit specification of patches defined on whatever scale data are available or can be reasonably imputed. At any of these scales, the matrices we have derived can be calculated to provide more detailed and biologically meaningful alternatives to classic scalar metrics, such as vectorial capacity and , which ignore heterogeneity, mixing, and their sensitivity to finite vertebrate host numbers at the characteristic spatial scales of transmission. Such fine-scale analytical tools provide an important link between known theoretical insights and complex simulation-based models that are becoming increasingly applied to important, policy-relevant problems.

Methods
Mosquito blood meals are the focal event in pathogen transmission, and this model is based on a mathematical construct describing where mosquito-host encounters occur. Many mosquitoes have well-defined haunts and blood-feeding habits, such that blood feeding tends to occur in places that can be reasonably well characterized. These are rigorously described as a set of points, denoted , containing  objects, called blood-feeding habitats. One way of defining  could be to consider the collection of homes in a city, which might be appropriate for human populations afflicted by malaria or dengue. Another, more flexible option would be to impose a lattice over an area and aggregate blood-feeding that takes place nearest to each point on the lattice. In either case, mosquito movement among the blood-feeding habitats is based on some description of mosquito behaviors relevant to the ecological needs dictated by a given species' natural history. At times, adult female mosquitoes will make movement decisions based on the need for blood feeding, digestion and rest, sugar feeding, mating, egg laying, or other factors. At a minimum, movements of epidemiological interest are those geared towards blood feeding and egg laying. Movement behaviors of hosts are also complex, with requirements to visit certain locations for sustenance or social interactions, for example. To avoid the specificity of those complexities, we represent host movement simply by the proportion of an individual's time, on average, allocated at each blood-feeding habitat. Hosts do not necessarily allocate their time at a location because there are or are not mosquitoes present, so the proportion of time a host allocates at all blood-feeding habitats could sum to less than one if it spends some of its time elsewhere. The way these assumptions manifest mathematically and their relevance to transmission dynamics are discussed in detail in the following sections.

Mosquito Movement
In our model, adult mosquitoes emerge from aquatic habitats, which are contained by a set of spatially referenced points  containing  objects. After they emerge, mosquitoes alternate moving between aquatic habitats and blood-feeding habitats. Every adult female mosquito that survives a pair of consecutive moves is assumed to lay eggs and blood feed once within a fixed interval corresponding to the length of the feeding cycle. Departures from these assumptions will vary in kind and degree for different mosquito species, but these core assumptions nonetheless constitute general features of the mosquito life cycle. With respect to our model,  and  together define a template for mosquito movement, and mosquito dispersal on these sets can be described concisely as a random walk on a weighted, bidirectional, bipartite graph.

Such random walks by mosquitoes are described by two matrices, one, an -by- matrix , describing mosquito movement to find a vertebrate host and feed on blood and the other, an -by- matrix , describing mosquito movement to find aquatic habitat and lay eggs. Other mosquito needs, such as finding mates, digestion and resting, and sugar feeding, are assumed to occur somewhere along the way and are not modeled explicitly. Let an element  in  denote the proportion of mosquitoes that start from the  aquatic habitat and end at the  blood-feeding habitat with a successful blood meal. Similarly, let an element  in  denote the proportion of mosquitoes that start from the  blood feeding habitat and end at the  aquatic habitat after laying eggs. Elements of  and  thus contain information about movement and mortality, with the sum across each row of  and  giving the mortality of mosquitoes between leaving one habitat and reaching any habitat of the other type. Mortality risks at different habitats could be quite variable, and survival during each flight could depend in some way on the distance traveled, type of habitat traversed, climatic conditions, or other factors.

Host Movement
For the purposes of transmission, host movement can be characterized by the proportional allocation of each host's time at each blood-feeding habitat and by the distribution of bites among the hosts that frequent each blood-feeding habitat. First, let  denote a set of  hosts, which remains fixed because we do not consider host births or deaths over the relatively short timescale of interest here. Then let each element  of an -by- matrix  denote the fraction of time that the  host spends at the  blood-feeding habitat. In the matrix , each row thus represents a host's proportional allocation of time at the different blood-feeding habitats. Hosts can also spend some of their time at places outside the set of blood-feeding habitats, implying that .

The number of bites a host receives depends not only on how it allocates its time at different locations, but also on how attractive mosquitoes find that host to be relative to other hosts at those locations and how effective a host's avoidance or defensive behaviors are. To take individual factors that affect biting attractiveness and avoidance or defensive behaviors into account, we assign each host a biting suitability score . The normalized values of those scores for all hosts at a given location give the probabilities that a mosquito at that location will bite each of those hosts. Given that  allows for different hosts to spend different proportions of their time at different blood-feeding habitats, the distribution of bites on hosts at each blood-feeding habitat must be jointly determined by host time allocation and biting suitability. Mathematically, bites at blood-feeding habitat  are distributed on hosts according to the vector (2)  where  is the proportion of bites taken on the focal host species at . Collating these vectors for all blood-feeding habitats yields an -by- matrix .

Stochastic Transmission Dynamics
Having described mosquito movement with  and , host movement with , and the distribution of bites on individual hosts with , it is now possible to layer a model of pathogen transmission on top of this framework. Here we specify a stochastic, individual-based SEIR model of host infection dynamics (susceptible, exposed, infected, recovered) and an SEI model of mosquito infection dynamics, although our framework is also capable of accommodating other types of infection dynamics. We describe an equivalent deterministic model that aggregates hosts and blood-feeding habitats in Text S1.

The infection status of host  is described by the  entries of binary vectors , , , and . Infected hosts progress through each stage , where  is an integer number of feeding cycles that specifies the duration of pathogen latency in hosts. Infectious hosts progress through stages  until they recover at some time specified by a failure distribution (3a)   (3b)   (3c)  which defines the probability of recovering after  feeding cycles conditional on still being infectious then. The probability mass function  and cumulative distribution function  define the failure distribution, and the mean duration of infectiousness is . Mosquito infection dynamics are modeled by partitioning adult female abundance, , into vectors of length  for each infection state, , , and  for , where  is an integer number of feeding cycles that specifies the duration of pathogen latency in mosquitoes. The other parameters relevant to transmission include the proportion  of infectious mosquito bites that cause a host infection and the proportion  of bites on infectious hosts that infect a mosquito. These quantities combine in the following way to completely specify the stochastic, individual-based dynamics for hosts, (4a)   (4b)   (4c)   (4d)   (4e)   (4f)  and for mosquitoes, (5a)   (5b)   (5c)   (5d)   (5e)  where  is a vector containing the number of new adult females emerging from . The Bernoulli, Binomial, and Multinomial functions generate random numbers from those distributions with the supplied parameters. Random numbers are drawn independently across the vectors or matrices of parameters supplied, such that the dimensions of the vectors produced by the random-number functions balance with the dimensions of other terms in those equations.

Although this formulation emphasizes heterogeneity and stochasticity in movement, biting, and host recovery, it is possible to extend the model to account for several other factors. For example, some mosquito species are known to often take multiple blood meals between successive egg-laying events [85], yet eqq. (4) and (5) only allow for one blood meal per mosquito per gonotrophic cycle. If, on the other hand, mosquitoes take an average of  blood meals per gonotrophic cycle, this could be incorporated into transmission dynamics by multiplying  by  in eq. (4a) and by replacing  with  in eq. (5b). Other factors that could be incorporated into a more refined version of the model for specific applications include individual-level heterogeneity in the probability that hosts confer infections to mosquitoes that bite them, among others. Factors relevant to transmission could also display heterogeneity at broader spatial scales or over time, such as temperature-dependent probabilities that Aedes mosquitoes confer dengue infections to humans.

Heterogeneous Biting
Heterogeneous biting arises naturally from factors that contribute to aggregated feeding at multiple spatial scales; e.g., in the neighborhood of aquatic habitats, at blood-feeding habitats, and on individuals. Among individual hosts, heterogeneous biting is characterized by , as already described. Among neighborhoods and blood-feeding habitats, heterogeneous biting is driven by spatial variation in the productivity of nearby aquatic habitats, the distribution of aquatic habitats and blood-feeding habitats relative to one another, and mosquito movement behavior. These factors can be combined into a vector of length  that describes the expected number of bites per feeding cycle at each blood-feeding habitat: (6)  where  is the average number of new adult females arising from each aquatic habitat per feeding cycle. Heterogeneous biting on the scale of individual hosts depends not only on spatial variation in biting intensity, but also on how individual hosts allocate their time at those locations and on the relative biting attractiveness of individuals at a location. Equipped with a matrix  that encapsulate these factors, we can define an -by- matrix, (7)  that gives the expected number of bites per feeding cycle on host  at blood-feeding habitat . The notation diag() denotes a matrix with entries of the vector  along its diagonal and 0 elsewhere.

Pathogen Dispersion by Mosquitoes
Infected mosquitoes disperse pathogens across space as they make alternating movements between blood-feeding and aquatic habitats. Some mosquitoes might alternate repeatedly between a single blood-feeding habitat and a single aquatic habitat, whereas others might wander far from their natal aquatic habitat over the course of multiple feeding cycles. The movement paths that mosquitoes ultimately realize depend on their movement behavior, on their longevity, and on the spatial arrangement of blood-feeding and aquatic habitats. The distribution of paths along which pathogens are vectored by mosquitoes can be summarized with the -by- matrix (8)  which takes into account mortality and movement of mosquitoes between different habitat types after the  feeding cycles required for pathogen incubation in the mosquito. Each row of  thus gives the expected number of potentially infectious bites at each blood-feeding habitat that originated from a single mosquito infected at a given blood-feeding habitat.

Pathogen Dispersion by Hosts
The dispersion of a pathogen from mosquitoes at one location to mosquitoes at another location by a mobile vertebrate host requires two bites on a single host: one at each location. One way to quantify this host-mediated element of pathogen dispersion is with the probability distribution of where secondary bites occur on an individual that received a primary bite at a given location, or (9)  where  and  are elements of the set of blood-feeding habitats  and Pr denotes the probability of a specified event. Successive bites must occur on a single host, however, so this probability must be further conditioned on each individual host , yielding (10)  The first probability on the right-hand side of eq. (10) is given by elements (11)  of an -by- matrix , while the second is given by . The probability in eq. (20) for each  pair of blood-feeding habitats is then given by the  entry of the -by- matrix (12)  Each row of  then contains the expected distribution of where secondary bites occur on a host that received a primary bite at a given location.

Pathogen Amplification
Given the species-specific dispersion networks above, it is now possible to derive networks that describe pathogen dispersion through the entirety of the transmission cycle. Defining this cycle to begin and end in hosts, we obtain the expected number of secondary bites on each host arising from primary bites on a host  over the course of a single feeding cycle. Host  receives an average of  bites per feeding cycle at blood-feeding habitat . Each of the mosquitoes that bite at  then go on to make  bites at all the other blood-feeding habitats, which get distributed on hosts according to . These steps combine mathematically to give an -by- matrix, (13)  where  denotes transpose. In its entirety, the matrix  provides a description of the flow of mosquito biting from each host to every other host. Summing over all possible recipient hosts  for each primary host  yields (14)  which is the expected number of secondary bites on all hosts arising from primary bites on host  over the course of a single feeding cycle. The average of  over all  is the per-feeding-cycle analogue of the classical vectorial capacity metric, which measures per-host, daily pathogen amplification by mosquitoes, from Ross-Macdonald theory [71].

Host Infection
To describe how potentially infectious bites translate into new host infections, we must address at least three additional issues. First, the efficiency of pathogen transmission during a blood meal is not perfect. Mathematically,  must be discounted by . Second, secondary bites on hosts arise repeatedly over  feeding cycles, on average, during which the primary host remains infectious. Third, consider that any number of infectious bites on a susceptible host  will have the same result: one and only one new host infection. We therefore introduce (15)  which is the probability that host  receives one or more secondary infectious bites arising from host 
[68]. The expected number of secondary infections on each host is also equal to  and is thus subject to the reasonable bound of a maximum of one new infection per host. Summing over all possible secondary hosts, we see that the expected number of secondary infections on all hosts in a susceptible population arising from a single infection in host  is (16)  Each  is an individual-specific equivalent of the literal definition of the basic reproductive number  from Ross-Macdonald theory; i.e., the expected number of secondary host infections arising from a single infected host in an otherwise susceptible population [86]. As noted by [21], the dominant eigenvalue of  is equivalent to the definition of  as a threshold for pathogen invasion and persistence.

Whereas  defines expected secondary infections from one host to another, we can also define a spatial analogue of , which we call , whose  entry specifies the expected number of secondary host infections at feeding habitat  that derive from a primary host infection incurred at feeding habitat . This matrix is defined by the equation (17)  which combines  with all the possible hosts that could incur an infection at  () and all the possible locations that secondarily infected hosts could incur their infections ().

Supporting Information
Text S1 Additional details of the model and analysis.

(PDF)

Click here for additional data file.

 We thank RC Reiner, TJ Hladish, and JRC Pulliam for feedback on the manuscript. Thanks to J Stoller for producing Fig. 1.
